---
import Layout from "../layouts/Layout.astro";
import GovernorRaces from "../components/ui/GovernorRaces";
import { fetchGovernorRaces } from "../lib/queries";

const govRaces = await fetchGovernorRaces();

const competitive = govRaces.filter((r) =>
  ["Toss-up", "Lean R", "Lean D", "Likely R", "Likely D"].includes(r.rating)
);
const openSeats = govRaces.filter((r) => r.isOpenSeat);
const tossups = govRaces.filter((r) => r.rating === "Toss-up");
---

<Layout title="2026 Governor Races" description="36 states elect governors in 2026. See which races are competitive and why they matter.">
  <section class="max-w-5xl mx-auto py-16 px-4">
    <h1 class="text-3xl md:text-4xl font-bold mb-2">2026 Governor Races</h1>
    <p class="text-lg text-slate-500 mb-10">
      {govRaces.length} states elect governors this cycle. {tossups.length} toss-ups, {competitive.length} competitive overall.
    </p>

    <!-- Key Stats -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
      <div class="bg-slate-50 rounded-xl p-6 text-center">
        <div class="text-3xl font-bold text-tossup mb-1">{competitive.length}</div>
        <div class="text-sm font-medium text-slate-500">Competitive Races</div>
        <p class="text-xs text-slate-400 mt-2">Toss-up through Likely</p>
      </div>
      <div class="bg-slate-50 rounded-xl p-6 text-center">
        <div class="text-3xl font-bold text-slate-700 mb-1">{openSeats.length}</div>
        <div class="text-sm font-medium text-slate-500">Open Seats</div>
        <p class="text-xs text-slate-400 mt-2">Term-limited or retiring</p>
      </div>
      <div class="bg-slate-50 rounded-xl p-6 text-center">
        <div class="text-3xl font-bold text-slate-700 mb-1">4 yrs</div>
        <div class="text-sm font-medium text-slate-500">Term Length</div>
        <p class="text-xs text-slate-400 mt-2">NH &amp; VT elect every 2 years</p>
      </div>
    </div>

    <!-- Explainer -->
    <div class="bg-slate-900 text-white rounded-xl p-6 mb-10">
      <p class="text-sm leading-relaxed">
        Why 36 and not 50? Governors serve 4-year terms on staggered schedules &mdash;
        roughly half the states vote for governor in midterm years. New Hampshire and Vermont are exceptions:
        they elect governors every 2 years.
        Open seats (where the incumbent is term-limited or retiring) are where the biggest shifts happen.
      </p>
    </div>

    <!-- Races -->
    {govRaces.length > 0 ? (
      <GovernorRaces client:load races={govRaces} />
    ) : (
      <div class="bg-slate-50 border border-slate-200 rounded-lg p-6">
        <p class="text-sm text-slate-500">
          Governor race data is being loaded. Check back soon, or explore the
          <a href="/senate" class="text-dem underline">Senate races</a> or
          <a href="/house" class="text-dem underline">House races</a>.
        </p>
      </div>
    )}

    <!-- About Governor Elections -->
    <div class="space-y-6 mt-12">
      <h2 class="text-2xl font-bold">Why Governor Races Matter</h2>
      <p class="text-slate-600">
        Governors have enormous power over daily life &mdash; they sign or veto state laws,
        set budgets for schools and roads, appoint judges, and lead emergency responses.
        In many states, the governor can also influence <strong>redistricting</strong>, which shapes
        congressional districts for a decade.
      </p>

      <h2 class="text-2xl font-bold">Open Seats Are the Battleground</h2>
      <p class="text-slate-600">
        {openSeats.length} of these {govRaces.length} races are open seats where the incumbent
        isn't running &mdash; either due to term limits or retirement.
        Without the incumbency advantage (sitting governors win re-election ~75% of the time),
        these races are far more competitive.
      </p>

      <h2 class="text-2xl font-bold">The Bigger Picture</h2>
      <p class="text-slate-600">
        Governors also play a role in federal politics. They can appoint U.S. Senators to fill vacancies,
        influence state election laws, and shape their party's bench of future presidential candidates.
        Several 2026 governor candidates are already seen as potential 2028 or 2032 presidential hopefuls.
      </p>
    </div>
  </section>
</Layout>
